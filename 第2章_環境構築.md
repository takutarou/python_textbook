# 第2章：環境構築

## この章で学ぶこと
- Minicondaのインストール方法
- VS Codeのインストールと初期設定
- 作業フォルダの作り方とルール

この章では、実際に手を動かしてPython開発環境を構築していきます。

---

## 2.1 Minicondaのインストール

### Minicondaとは

MinicondaはPythonとconda（環境管理ツール）がセットになったパッケージです。

**AnacondaとMinicondaの違い：**

| 項目 | Anaconda | Miniconda |
|------|----------|-----------|
| 容量 | 大きい（約3GB） | 小さい（約50MB） |
| 初期ライブラリ | 最初から大量に入っている | 必要最小限のみ |
| ライセンス | **商用利用の場合、条件によって有料** | **完全無料** |
| おすすめ | 個人利用や小規模組織 | 企業での利用、必要なものだけ入れたい人 |

### ライセンスに関する重要な注意

**Anacondaの商用ライセンス：**

2020年以降、Anacondaは以下の条件を満たす組織での商用利用が有料になりました：

- 従業員数が200名以上の組織
- 年間収益が一定基準を超える組織

該当する場合、Anaconda Commercial Editionのライセンス購入が必要です。

**当社の状況：**

当社はAnacondaの有料ライセンス対象に該当するため、**Minicondaを使用する必要があります**。

> **重要：** Minicondaはオープンソースであり、企業規模に関わらず完全に無料で使用できます。conda自体の機能は同じなので、開発に支障はありません。

**今回Minicondaを選ぶ理由：**
- **ライセンスの問題がなく、完全無料で使える**（最重要）
- 軽量でインストールが早い
- 必要なライブラリだけを選んで入れる習慣がつく
- プロジェクトごとの環境管理の概念を理解しやすい

### インストール手順

#### ステップ1：インストーラーのダウンロード

1. 公式サイトにアクセス
   - URL: https://docs.conda.io/en/latest/miniconda.html

2. 自分のOSに合ったインストーラーをダウンロード
   - **Windows**: `Miniconda3 Windows 64-bit`
   - **Mac (Intel)**: `Miniconda3 macOS Intel x86 64-bit pkg`
   - **Mac (Apple Silicon)**: `Miniconda3 macOS Apple M1 64-bit pkg`

**確認方法：**
- Windowsの場合：ほぼすべて64-bit
- Macの場合：
  - 左上のAppleメニュー → 「このMacについて」
  - 「チップ」の項目を確認
    - `Apple M1/M2/M3` → Apple Silicon
    - `Intel Core i5/i7` → Intel

#### ステップ2：インストーラーの実行

**Windowsの場合：**

1. ダウンロードした `.exe` ファイルをダブルクリック

2. インストールウィザードが起動
   - 「Next」をクリック
   - ライセンスに同意（「I Agree」）

3. **重要：** インストールタイプの選択
   - `Just Me (recommended)` を選択

4. **重要：** インストール先の指定
   - デフォルトのままでOK（変更不要）
   - パスに日本語が含まれていないことを確認

5. **最重要：** Advanced Optionsの設定
   ```
   ☐ Add Miniconda3 to my PATH environment variable
   ☑ Register Miniconda3 as my default Python 3.x
   ```
   - **1つ目のチェックボックスは空欄のまま**（チェックしない）
   - 2つ目はチェックを入れる

   > **なぜPATHに追加しないのか？**
   > - 他のPythonと競合する可能性を避けるため
   > - Anaconda Promptという専用のターミナルを使うため

6. 「Install」をクリックしてインストール開始

7. 完了したら「Finish」

**Macの場合：**

1. ダウンロードした `.pkg` ファイルをダブルクリック

2. インストールウィザードに従って進める
   - 「続ける」をクリック
   - ライセンスに同意

3. インストール先はデフォルトのままでOK

4. インストール完了

5. **ターミナルの初期化（重要）**
   - インストール後、ターミナル（またはiTerm2）を開く
   - 以下のコマンドを実行：
   ```bash
   conda init zsh
   ```
   - ターミナルを一度閉じて、再度開く

#### ステップ3：インストールの確認

**Windowsの場合：**

1. スタートメニューから `Anaconda Prompt (miniconda3)` を検索して起動

2. 以下のコマンドを入力してEnterキーを押す：
   ```bash
   conda --version
   ```

3. バージョン番号が表示されればOK
   ```
   conda 24.1.2
   ```
   （数字は異なる場合があります）

**Macの場合：**

1. ターミナルを開く
   - Spotlight検索（Command + Space）で「ターミナル」と入力

2. 以下のコマンドを入力してEnterキーを押す：
   ```bash
   conda --version
   ```

3. バージョン番号が表示されればOK

4. プロンプトの先頭に `(base)` と表示されていることを確認
   ```
   (base) username@MacBook-Pro ~ %
   ```
   → これはbase環境が有効になっている印です

### よくあるトラブルと対処法

#### 「conda: command not found」と表示される（Mac）

**原因：** ターミナルの初期化ができていない

**対処法：**
```bash
# ホームディレクトリに移動
cd ~

# .zshrcファイルを確認
cat .zshrc
```

`# >>> conda initialize >>>` という記述があるか確認。なければ：
```bash
~/miniconda3/bin/conda init zsh
```
を実行してターミナルを再起動。

#### 「conda is not recognized...」と表示される（Windows）

**原因：** Anaconda Promptではなく、通常のコマンドプロンプトを開いている

**対処法：**
- スタートメニューから「Anaconda Prompt (miniconda3)」を起動する
- 通常の「コマンドプロンプト」や「PowerShell」ではなく、専用のものを使う

---

## 2.2 VS Codeのセットアップ

### VS Codeのインストール

#### ステップ1：ダウンロード

1. 公式サイトにアクセス
   - URL: https://code.visualstudio.com/

2. 自動で自分のOSに合ったダウンロードボタンが表示される
   - 「Download for Windows/Mac」をクリック

#### ステップ2：インストール

**Windowsの場合：**

1. ダウンロードした `.exe` ファイルをダブルクリック

2. セットアップウィザードに従う
   - ライセンスに同意
   - インストール先はデフォルトでOK

3. **重要：** 追加タスクの選択で以下にチェック
   ```
   ☑ デスクトップ上にアイコンを作成する
   ☑ PATHへの追加（再起動後に使用可能）
   ☑ サポートされているファイルの種類のエディターとして、Codeを登録する
   ☑ [エクスプローラーのフォルダーコンテキストメニューに[Codeで開く]アクションを追加する]
   ```

4. 「インストール」をクリック

**Macの場合：**

1. ダウンロードした `.zip` ファイルをダブルクリックして解凍

2. 解凍された `Visual Studio Code.app` を「アプリケーション」フォルダにドラッグ

3. 「アプリケーション」フォルダから VS Code を起動

### Python拡張機能のインストール

VS CodeでPythonを快適に使うには、専用の拡張機能が必要です。

#### ステップ1：拡張機能パネルを開く

1. VS Codeを起動

2. 左側のアイコンバーから「拡張機能」をクリック
   - アイコン：四角が4つ並んだマーク
   - ショートカット：
     - Windows: `Ctrl + Shift + X`
     - Mac: `Cmd + Shift + X`

#### ステップ2：Python拡張機能をインストール

1. 検索ボックスに `Python` と入力

2. **「Python」（公式、Microsoftが提供）** を探す
   - 作成者：Microsoft
   - ダウンロード数が最も多いもの

3. 「インストール」ボタンをクリック

4. 数十秒～数分でインストール完了

#### ステップ3：追加で入れると便利な拡張機能（オプション）

1. **「Python Debugger」** - デバッグ機能を強化（Microsoftが提供）

2. **「Pylance」** - コード補完や型チェックを強化（通常Pythonと一緒に自動でインストールされます）

3. **「Japanese Language Pack for Visual Studio Code」** - 日本語化
   - インストール後、VS Codeを再起動すると日本語で表示される
   - 英語のままでも問題ありません（エラーメッセージなどは英語の方が調べやすい場合も）

### VS Codeの基本的な画面構成

```
┌─────────────────────────────────────────────────┐
│  ファイル  編集  表示  ...           ［最小化］［最大化］［×］│
├───┬─────────────────────────────────────────┐
│ ① │  ②エクスプローラー（ファイル一覧）        │
│   │                                           │
│ア │  📁 プロジェクトフォルダ                  │
│イ │    📄 test.py                            │
│コ │    📄 main.py                            │
│ン │                                           │
│   ├─────────────────────────────────────────┤
│バ │  ③エディタ（コードを書く場所）            │
│｜ │                                           │
│   │  1  import pandas as pd                  │
│   │  2                                        │
│   │  3  print("Hello World")                 │
│   │                                           │
├───┼─────────────────────────────────────────┤
│   │  ④ターミナル                              │
│   │  (base) PS C:\Users\user\project>        │
│   │                                           │
└───┴─────────────────────────────────────────┘
```

**各部の説明：**

1. **①アクティビティバー（左端）**
   - ファイル操作、検索、拡張機能などの機能を切り替え

2. **②エクスプローラー**
   - プロジェクトのファイル・フォルダ一覧
   - ファイルをクリックすると③のエディタで開く

3. **③エディタ**
   - コードを実際に書く場所
   - タブで複数のファイルを切り替えられる

4. **④ターミナル**
   - VS Code内でコマンドを実行できる
   - メニューから「表示」→「ターミナル」で表示
   - ショートカット：`` Ctrl + ` ``（バッククォート）

### ターミナルの設定（Windows）

WindowsでVS Codeのターミナルをcondaで使えるようにする設定が必要です。

#### ステップ1：デフォルトプロファイルの変更

1. VS Codeでターミナルを開く（`` Ctrl + ` ``）

2. ターミナルパネルの右側にある「＋」ボタンの横の「∨」をクリック

3. 「Select Default Profile」を選択

4. 「Command Prompt」を選択

#### ステップ2：conda初期化

1. ターミナルで以下のコマンドを実行：
   ```bash
   conda init cmd.exe
   ```

2. VS Codeを完全に閉じて再起動

3. ターミナルを開くと、先頭に `(base)` と表示されればOK

**Macの場合：**
- 特別な設定は不要
- ターミナルを開けば自動でcondaが使える状態になっています

---

## 2.3 作業フォルダの作成

### フォルダ管理の重要性

プログラミングでは、**プロジェクトごとにフォルダを分ける**ことが非常に重要です。

**悪い例：**
```
デスクトップ
  ├─ test.py
  ├─ test2.py
  ├─ データ分析.py
  ├─ 最終版.py
  ├─ 最終版2.py
  └─ 本当の最終版.py  ← カオス！
```

**良い例：**
```
ドキュメント/python_projects
  ├─ data_analysis/
  │   ├─ main.py
  │   └─ data.csv
  ├─ automation/
  │   ├─ script.py
  │   └─ output/
  └─ web_scraping/
      ├─ scraper.py
      └─ results/
```

### フォルダ名・ファイル名のルール

#### ❌ やってはいけないこと

1. **日本語を使う**
   ```
   ❌ データ分析/
   ❌ 売上集計.py
   ```
   → エラーの原因になることがある（文字コードの問題）

2. **スペースを使う**
   ```
   ❌ my project/
   ❌ data analysis.py
   ```
   → コマンド実行時にエラーが出やすい

3. **特殊文字を使う**
   ```
   ❌ project@2024/
   ❌ script#1.py
   ```
   → システムによっては認識されない

#### ✅ 推奨される命名規則

1. **英数字とアンダースコア、ハイフン**
   ```
   ✅ data_analysis/
   ✅ sales_report.py
   ✅ project-2024/
   ```

2. **小文字を使う**
   ```
   ✅ myproject/
   ✅ main.py
   ```

3. **分かりやすい名前にする**
   ```
   ✅ excel_automation/
   ✅ customer_data_analysis/
   ❌ script1/
   ❌ test123/
   ```

### 作業フォルダの作成手順

#### 方法1：エクスプローラー/Finderから作成（初心者向け）

**Windowsの場合：**
1. エクスプローラーを開く
2. ドキュメントフォルダに移動
3. 右クリック → 「新規作成」→「フォルダー」
4. 名前を `python_projects` にする
5. その中に、例えば `first_project` フォルダを作成

**Macの場合：**
1. Finderを開く
2. ホームフォルダ（または書類フォルダ）に移動
3. 右クリック → 「新規フォルダ」
4. 名前を `python_projects` にする
5. その中に、例えば `first_project` フォルダを作成

#### 方法2：ターミナルから作成（慣れてきたら）

```bash
# Windowsの場合（Anaconda Prompt）
cd %USERPROFILE%\Documents
mkdir python_projects
cd python_projects
mkdir first_project

# Macの場合
cd ~/Documents
mkdir python_projects
cd python_projects
mkdir first_project
```

### VS Codeでフォルダを開く

1. VS Codeを起動

2. 「ファイル」→「フォルダーを開く」（Macは「フォルダを開く」）

3. 先ほど作成した `first_project` フォルダを選択

4. 「フォルダーの選択」をクリック

5. エクスプローラーに `FIRST_PROJECT` と表示される

**ポイント：**
- **フォルダ単位で開く**ことが重要
- ファイル単位ではなく、フォルダごと開く
- これにより、そのプロジェクトに関連するすべてのファイルを管理しやすくなる

---

## まとめ

この章では、Python開発環境の構築を行いました：

- ✅ Minicondaをインストールして、condaコマンドが使えることを確認
- ✅ VS Codeをインストールして、Python拡張機能を追加
- ✅ VS Codeのターミナルでcondaが使えるように設定
- ✅ プロジェクト用のフォルダを作成し、命名規則を学習

次の章では、いよいよconda環境を作成して、プロジェクトごとの環境管理を実践します。

---

## 確認問題

1. MinicondaとAnacondaの違いは何ですか？
2. Windowsで、VS Codeのターミナルでcondaを使うために必要な設定は何ですか？
3. フォルダ名やファイル名に日本語やスペースを使わない方が良い理由は何ですか？
4. VS Codeでフォルダを開く時、なぜファイル単位ではなくフォルダ単位で開くのですか？

---

**前の章へ：** [第1章：Python開発を始める前に](./第1章_Python開発を始める前に.md)
**次の章へ：** [第3章：conda環境の理解と作成](./第3章_conda環境の理解と作成.md)
